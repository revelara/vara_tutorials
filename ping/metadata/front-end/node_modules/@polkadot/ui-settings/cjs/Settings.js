"use strict";
var _Settings_emitter, _Settings_apiType, _Settings_apiUrl, _Settings_camera, _Settings_i18nLang, _Settings_icon, _Settings_ledgerConn, _Settings_locking, _Settings_metadataUp, _Settings_prefix, _Settings_storage, _Settings_uiMode, _Settings_uiTheme, _Settings_notification;
Object.defineProperty(exports, "__esModule", { value: true });
exports.settings = exports.Settings = void 0;
const tslib_1 = require("tslib");
const eventemitter3_1 = require("eventemitter3");
const store_1 = tslib_1.__importDefault(require("store"));
const util_1 = require("@polkadot/util");
const index_js_1 = require("./defaults/index.js");
function withDefault(options, option, fallback) {
    const _option = option || fallback;
    return options.some(({ value }) => value === _option)
        ? _option
        : fallback;
}
class Settings {
    constructor() {
        _Settings_emitter.set(this, void 0);
        _Settings_apiType.set(this, void 0);
        // will become deprecated for supporting substrate connect light clients. apiType structure should be used instead
        _Settings_apiUrl.set(this, void 0);
        _Settings_camera.set(this, void 0);
        _Settings_i18nLang.set(this, void 0);
        _Settings_icon.set(this, void 0);
        _Settings_ledgerConn.set(this, void 0);
        _Settings_locking.set(this, void 0);
        _Settings_metadataUp.set(this, void 0);
        _Settings_prefix.set(this, void 0);
        _Settings_storage.set(this, void 0);
        _Settings_uiMode.set(this, void 0);
        _Settings_uiTheme.set(this, void 0);
        _Settings_notification.set(this, void 0);
        const settings = store_1.default.get('settings') || {};
        tslib_1.__classPrivateFieldSet(this, _Settings_emitter, new eventemitter3_1.EventEmitter(), "f");
        // will become deprecated for supporting substrate connect light clients. apiType structure should be used instead
        tslib_1.__classPrivateFieldSet(this, _Settings_apiUrl, (typeof settings.apiUrl === 'string' && settings.apiUrl) || (util_1.hasProcess && process.env && process.env.WS_URL) || index_js_1.ENDPOINT_DEFAULT.value, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_apiType, { param: tslib_1.__classPrivateFieldGet(this, _Settings_apiUrl, "f"), type: 'json-rpc' }, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_camera, withDefault(index_js_1.CAMERA, settings.camera, index_js_1.CAMERA_DEFAULT), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_ledgerConn, withDefault(index_js_1.LEDGER_CONN, settings.ledgerConn, index_js_1.LEDGER_CONN_DEFAULT), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_i18nLang, settings.i18nLang || index_js_1.LANGUAGE_DEFAULT, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_icon, settings.icon || index_js_1.ICON_DEFAULT, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_locking, settings.locking || index_js_1.LOCKING_DEFAULT, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_metadataUp, withDefault(index_js_1.METADATA_UP, settings.storage, index_js_1.METADATA_UP_DEFAULT), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_notification, settings.notification || index_js_1.NOTIFICATION_DEFAULT, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_prefix, (0, util_1.isUndefined)(settings.prefix) ? index_js_1.PREFIX_DEFAULT : settings.prefix, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_storage, withDefault(index_js_1.STORAGE, settings.storage, index_js_1.STORAGE_DEFAULT), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_uiMode, settings.uiMode || index_js_1.UIMODE_DEFAULT, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_uiTheme, settings.uiTheme || index_js_1.UITHEME_DEFAULT, "f");
    }
    get camera() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_camera, "f");
    }
    get apiType() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_apiType, "f");
    }
    get apiUrl() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_apiUrl, "f");
    }
    get i18nLang() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_i18nLang, "f");
    }
    get icon() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_icon, "f");
    }
    get notification() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_notification, "f");
    }
    get ledgerConn() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_ledgerConn, "f");
    }
    get locking() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_locking, "f");
    }
    get metadataUp() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_metadataUp, "f");
    }
    get prefix() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_prefix, "f");
    }
    get storage() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_storage, "f");
    }
    get uiMode() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_uiMode, "f");
    }
    get uiTheme() {
        return tslib_1.__classPrivateFieldGet(this, _Settings_uiTheme, "f");
    }
    get availableCamera() {
        return index_js_1.CAMERA;
    }
    get availableCryptos() {
        return index_js_1.CRYPTOS;
    }
    get availableCryptosEth() {
        return index_js_1.CRYPTOS_ETH;
    }
    get availableCryptosLedger() {
        return index_js_1.CRYPTOS_LEDGER;
    }
    get availableIcons() {
        return index_js_1.ICONS;
    }
    get availableLedgerConn() {
        return index_js_1.LEDGER_CONN;
    }
    get availableLocking() {
        return index_js_1.LOCKING;
    }
    get availableMetadataUp() {
        return index_js_1.METADATA_UP;
    }
    get availableNodes() {
        return index_js_1.ENDPOINTS;
    }
    get availablePrefixes() {
        return index_js_1.PREFIXES;
    }
    get availableStorage() {
        return index_js_1.STORAGE;
    }
    get availableUIModes() {
        return index_js_1.UIMODES;
    }
    get availableUIThemes() {
        return index_js_1.UITHEMES;
    }
    get() {
        return {
            apiType: tslib_1.__classPrivateFieldGet(this, _Settings_apiType, "f"),
            apiUrl: tslib_1.__classPrivateFieldGet(this, _Settings_apiUrl, "f"),
            camera: tslib_1.__classPrivateFieldGet(this, _Settings_camera, "f"),
            i18nLang: tslib_1.__classPrivateFieldGet(this, _Settings_i18nLang, "f"),
            icon: tslib_1.__classPrivateFieldGet(this, _Settings_icon, "f"),
            ledgerConn: tslib_1.__classPrivateFieldGet(this, _Settings_ledgerConn, "f"),
            locking: tslib_1.__classPrivateFieldGet(this, _Settings_locking, "f"),
            metadataUp: tslib_1.__classPrivateFieldGet(this, _Settings_metadataUp, "f"),
            notification: tslib_1.__classPrivateFieldGet(this, _Settings_notification, "f"),
            prefix: tslib_1.__classPrivateFieldGet(this, _Settings_prefix, "f"),
            storage: tslib_1.__classPrivateFieldGet(this, _Settings_storage, "f"),
            uiMode: tslib_1.__classPrivateFieldGet(this, _Settings_uiMode, "f"),
            uiTheme: tslib_1.__classPrivateFieldGet(this, _Settings_uiTheme, "f")
        };
    }
    set(settings) {
        tslib_1.__classPrivateFieldSet(this, _Settings_apiType, settings.apiType || tslib_1.__classPrivateFieldGet(this, _Settings_apiType, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_apiUrl, settings.apiUrl || tslib_1.__classPrivateFieldGet(this, _Settings_apiUrl, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_camera, settings.camera || tslib_1.__classPrivateFieldGet(this, _Settings_camera, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_ledgerConn, settings.ledgerConn || tslib_1.__classPrivateFieldGet(this, _Settings_ledgerConn, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_i18nLang, settings.i18nLang || tslib_1.__classPrivateFieldGet(this, _Settings_i18nLang, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_icon, settings.icon || tslib_1.__classPrivateFieldGet(this, _Settings_icon, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_locking, settings.locking || tslib_1.__classPrivateFieldGet(this, _Settings_locking, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_metadataUp, settings.metadataUp || tslib_1.__classPrivateFieldGet(this, _Settings_metadataUp, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_notification, settings.notification || tslib_1.__classPrivateFieldGet(this, _Settings_notification, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_prefix, (0, util_1.isUndefined)(settings.prefix) ? tslib_1.__classPrivateFieldGet(this, _Settings_prefix, "f") : settings.prefix, "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_storage, settings.storage || tslib_1.__classPrivateFieldGet(this, _Settings_storage, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_uiMode, settings.uiMode || tslib_1.__classPrivateFieldGet(this, _Settings_uiMode, "f"), "f");
        tslib_1.__classPrivateFieldSet(this, _Settings_uiTheme, settings.uiTheme || tslib_1.__classPrivateFieldGet(this, _Settings_uiTheme, "f"), "f");
        const newValues = this.get();
        store_1.default.set('settings', newValues);
        tslib_1.__classPrivateFieldGet(this, _Settings_emitter, "f").emit('change', newValues);
    }
    on(type, cb) {
        tslib_1.__classPrivateFieldGet(this, _Settings_emitter, "f").on(type, cb);
    }
}
exports.Settings = Settings;
_Settings_emitter = new WeakMap(), _Settings_apiType = new WeakMap(), _Settings_apiUrl = new WeakMap(), _Settings_camera = new WeakMap(), _Settings_i18nLang = new WeakMap(), _Settings_icon = new WeakMap(), _Settings_ledgerConn = new WeakMap(), _Settings_locking = new WeakMap(), _Settings_metadataUp = new WeakMap(), _Settings_prefix = new WeakMap(), _Settings_storage = new WeakMap(), _Settings_uiMode = new WeakMap(), _Settings_uiTheme = new WeakMap(), _Settings_notification = new WeakMap();
exports.settings = new Settings();
